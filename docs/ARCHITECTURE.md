# Архитектура Task Manager

## Общий обзор

Task Manager построен на основе современной микросервисной архитектуры, разделяющей frontend и backend части приложения. Каждая часть работает в своем собственном контейнере Docker, что обеспечивает изоляцию и простоту развертывания.

## Компоненты системы

### Frontend (React + TypeScript)

#### Архитектурные слои:
1. **Представление (Components)**
   - Компоненты UI (React)
   - Страницы (Pages)
   - Общие компоненты (Common)

2. **Управление состоянием**
   - Контекст аутентификации (AuthContext)
   - Локальное состояние компонентов (useState)

3. **Сервисный слой**
   - API-клиент (api.service.ts)
   - Сервис аутентификации (auth.service.ts)

4. **Утилиты**
   - Типы TypeScript
   - Константы
   - Helpers

### Backend (FastAPI + SQLAlchemy)

#### Архитектурные слои:
1. **API Layer**
   - Роутеры (routers/)
   - Middleware
   - Валидация входных данных (Pydantic)

2. **Сервисный слой**
   - Бизнес-логика
   - Аутентификация
   - Rate Limiting

3. **Слой данных**
   - Модели SQLAlchemy
   - Миграции
   - Репозитории

4. **Инфраструктурный слой**
   - Конфигурация
   - Логирование
   - Обработка ошибок

## Безопасность

### Аутентификация
- JWT токены (access + refresh)
- Безопасное хранение паролей (bcrypt)
- Rate limiting для API endpoints

### Авторизация
- Проверка прав доступа к задачам
- Middleware для проверки токенов
- Защита от CSRF

## Масштабируемость

### Frontend
- Code Splitting
- Lazy Loading компонентов
- Оптимизация ре-рендеринга

### Backend
- Асинхронная обработка запросов
- Connection pooling для БД
- Кеширование

## Мониторинг и логирование

### Логирование
- Структурированные логи
- Уровни логирования
- Ротация логов

### Мониторинг
- Метрики API
- Мониторинг ошибок
- Производительность БД

## Процесс развертывания

### Docker
- Multi-stage builds
- Оптимизация размера образов
- Volume для персистентных данных

### Конфигурация
- Переменные окружения
- Конфигурационные файлы
- Секреты

## Диаграммы

### Компоненты системы
```
┌─────────────────┐     ┌──────────────┐     ┌─────────────┐
│    Frontend     │     │    Nginx     │     │   Backend   │
│  React + MUI    │────▶│   Reverse   │────▶│   FastAPI   │
│                 │     │    Proxy     │     │             │
└─────────────────┘     └──────────────┘     └─────────────┘
                                                    │
                                                    ▼
                                            ┌─────────────┐
                                            │  Database   │
                                            │ PostgreSQL  │
                                            └─────────────┘
```

### Процесс аутентификации
```
┌──────────┐     ┌────────────┐     ┌─────────────┐
│  Client  │     │  Frontend  │     │   Backend   │
└────┬─────┘     └─────┬──────┘     └──────┬──────┘
     │                 │                    │
     │    Login        │                    │
     │─────────────────>                    │
     │                 │      /auth/login   │
     │                 │───────────────────▶│
     │                 │                    │
     │                 │   JWT Tokens       │
     │                 │◀───────────────────│
     │    Tokens       │                    │
     │◀────────────────│                    │
     │                 │                    │
     │    Request      │                    │
     │─────────────────>     Request + JWT  │
     │                 │───────────────────▶│
     │                 │                    │
     │                 │     Response       │
     │    Response     │◀───────────────────│
     │◀────────────────│                    │
     │                 │                    │
```
